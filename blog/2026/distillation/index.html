<!DOCTYPE html> <html lang=""> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Recent Flow-Map Distillation Methods | Adam Abecid </title> <meta name="author" content="Adam Abecid"> <meta name="description" content="Recent developments of diffusion distillation techniques"> <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; media-src 'self' https:; frame-src 'self' https:; connect-src 'self' https:;"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://abecid.github.io/blog/2026/distillation/"> <script src="/assets/js/theme.js?v=5fea5159b787642c1bbc1f334d60f883"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Adam Abecid </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Recent Flow-Map Distillation Methods</h1> <p class="post-meta"> Created on February 20, 2026 </p> <p class="post-tags"> <a href="/blog/2026"> <i class="fa-solid fa-calendar fa-sm"></i> 2026 </a>   ·   <a href="/blog/tag/diffusion"> <i class="fa-solid fa-hashtag fa-sm"></i> diffusion</a>   <a href="/blog/tag/survey"> <i class="fa-solid fa-hashtag fa-sm"></i> survey</a>   ·   <a href="/blog/category/research-survey"> <i class="fa-solid fa-tag fa-sm"></i> research-survey</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Diffusion</p> <p>FlowMap</p> <p>MeanFlow</p> <p>Data Free Distillation</p> <p>Meta FlowMap</p> <h1 id="accelerating-generative-flows-from-flow-matching-to-data-free-and-stochastic-distillation">Accelerating Generative Flows: From Flow Matching to Data-Free and Stochastic Distillation</h1> <p>This post covers the theoretical progression of flow-based generative modeling, detailing the transition from instantaneous vector field regression (Flow Matching) to integral operator parameterization (Flow Maps), and the recent frontier of data-free, stochastic, and terminal-differentiated distillation frameworks.</p> <h2 id="1-fundamentals">1. Fundamentals</h2> <p><strong>Flow Matching (FM)</strong> constructs a deterministic coupling between a prior $p_{\text{prior}}(x_1)$ and a data distribution $p_{\text{data}}(x_0)$.</p> <ul> <li> <strong>Interpolant:</strong> $x_t = (1-t)x_0 + tx_1$ for $t \in [0, 1]$.</li> <li> <table> <tbody> <tr> <td> <strong>Conditional Velocity:</strong> $v_t(x_t</td> <td>x_0, x_1) = \frac{d}{dt}x_t = x_1 - x_0$.</td> </tr> </tbody> </table> </li> <li> <strong>Objective:</strong> Regress a neural vector field $u_\theta$ against the conditional velocity. \(\mathcal{L}_{FM}(\theta) = \mathbb{E}_{t, x_0, x_1} \|u_\theta(x_t, t) - (x_1 - x_0)\|^2\) At optimality, $u_\theta(x_t, t)$ matches the marginal velocity field. Generation requires iterative numerical ODE integration (many NFEs).</li> </ul> <p><strong>Flow Maps</strong> circumvent iterative integration by parameterizing the flow’s displacement operator.</p> <ul> <li> <strong>Definition:</strong> $\psi(x_t, t, s) = x_t + \int_t^s u(x_\tau, \tau) d\tau$.</li> <li> <strong>Parameterization:</strong> $f_\theta(x_t, t, s) = x_t + (s-t)F_\theta(x_t, t, s)$, where $F_\theta$ approximates the average velocity over the interval $[t, s]$.</li> </ul> <h2 id="2-progression-of-distillation-modalities">2. Progression of Distillation Modalities</h2> <ol> <li> <strong>Trajectory-Based Distillation (Consistency Models, early Flow Maps):</strong> Student directly regresses the teacher’s deterministic ODE trajectory. <em>Limitation:</em> Compounding integration errors and high sensitivity to teacher curvature.</li> <li> <strong>Distribution-Based Distillation (DMD, VSD):</strong> Drops strict trajectory matching for direct distributional alignment (e.g., GAN loss, reverse KL). <em>Limitation:</em> Computationally expensive fake score estimation.</li> <li> <strong>Data-Free &amp; Analytic Frameworks (FreeFlow, MeanFlow, TVM, MFM):</strong> Eliminate dependency on empirical dataset sampling by anchoring distillation strictly at the prior (FreeFlow), exploiting exact calculus identities (MeanFlow, TVM), or modeling true stochastic posteriors analytically (MFM).</li> </ol> <h2 id="3-core-derivations-and-objectives">3. Core Derivations and Objectives</h2> <h3 id="a-meanflow-exact-average-velocity-matching">A. MeanFlow: Exact Average Velocity Matching</h3> <p><em>Motivation:</em> Derives an analytic identity connecting average velocity to instantaneous velocity, enabling 1-NFE training without a pre-trained teacher.</p> <p><strong>Derivation:</strong> Define average velocity $u(z_t, r, t) = \frac{1}{t-r}\int_r^t v(z_\tau, \tau) d\tau$. Differentiate the integral w.r.t upper limit $t$ using the Leibniz rule: \(\frac{d}{dt}\left[ (t-r)u(z_t, r, t) \right] = v(z_t, t)\) Expand the total derivative $\frac{d}{dt}$: \(u + (t-r)(\partial_t u + v \cdot \nabla_{z_t} u) = v(z_t, t)\) <strong>Objective:</strong> The Jacobian-Vector Product (JVP) computes $\frac{d}{dt}u_\theta(z_t, r, t)$. The model regresses $u_\theta$ against the isolated $v_t$ term. \(\mathcal{L}_{MF}(\theta) = \mathbb{E}_{t,r,x_0,x_1} \|u_\theta(z_t, r, t) - \text{sg}\left(v_t - (t-r)\frac{d}{dt}u_\theta(z_t, r, t)\right)\|^2\)</p> <h3 id="b-freeflow-data-free-flow-map-distillation">B. FreeFlow: Data-Free Flow Map Distillation</h3> <p><em>Motivation:</em> Static dataset trajectories induce “Teacher-Data Mismatch” under Classifier-Free Guidance. FreeFlow isolates distillation to the prior ($t=1$) where teacher/student distributions are identical.</p> <p><strong>Derivation:</strong> Let $z \sim p_{\text{prior}}$ at $t=1$. Let integration interval be $\delta = 1-s$. The optimal flow map $F_{\theta^*}$ satisfies: \(\delta F_{\theta^*}(z, \delta) = \int_1^{1-\delta} -u(x(\tau), \tau) d\tau\) Differentiate w.r.t $\delta$: \(F_{\theta^*}(z, \delta) + \delta \partial_\delta F_{\theta^*}(z, \delta) = u(f_{\theta^*}(z, \delta), 1-\delta)\) <strong>Objective:</strong> (Predictor-Corrector) \(\mathcal{L}_{pred} = \mathbb{E}_{z,\delta} \left\| F_\theta(z, \delta) + \delta \partial_\delta F_\theta(z, \delta) - u_{\text{teach}}(f_\theta(z, \delta), 1-\delta) \right\|^2\) \(\mathcal{L}_{corr} = \mathbb{E}_{z,\delta,r,\epsilon} \left\| v_{\text{student}}(f_\theta(z,\delta)_r, r) - u_{\text{teach}}(f_\theta(z,\delta)_r, r) \right\|^2\)</p> <h3 id="c-terminal-velocity-matching-tvm">C. Terminal Velocity Matching (TVM)</h3> <p><em>Motivation:</em> Differentiating displacement at the initial bound $t$ ignores terminal geometry. Differentiating at terminal bound $s$ upper-bounds the 2-Wasserstein distance to the data distribution.</p> <p><strong>Derivation:</strong> Displacement $f(x_t, t, s) = \int_t^s u(x_r, r)dr$. Differentiate w.r.t the terminal bound $s$: \(\frac{d}{ds}f(x_t, t, s) = u(x_t + f(x_t, t, s), s)\) <strong>Objective:</strong> Ground-truth terminal velocity $u$ is intractable, so substitute a proxy instantaneous velocity model $u_\theta$, jointly co-trained: \(\mathcal{L}_{TVM}(\theta) = \mathbb{E} \left[ \left\|\frac{d}{ds}f_\theta(x_t, t, s) - u_\theta(x_t + f_\theta(x_t, t, s), s)\right\|_2^2 + \|u_\theta(x_s, s) - v_s\|_2^2 \right]\)</p> <h3 id="d-meta-flow-maps-mfm">D. Meta Flow Maps (MFM)</h3> <p><em>Motivation:</em> RLHF/Reward alignment requires $\nabla V_t$, demanding differentiable samples from the stochastic conditional posterior $p_{1|t}(\cdot | x_t)$. Deterministic flow maps collapse this variance. MFM amortizes an infinite family of auxiliary flow ODEs to match $p_{1|t}$.</p> <p><strong>Derivation:</strong> Construct an auxiliary ODE mapping noise $\epsilon \sim p_0$ to $p_{1|t}(\cdot | x_t)$. Parameterize via $\bar{X}<em>{s,u}(\bar{x}; t, x_t) = \bar{x} + (u-s)\hat{v}</em>{s,u}(\bar{x}; t, x_t)$. <strong>Objective:</strong> Analytically derive the true conditional ODE velocity $\bar{b}_s$ via GLASS flows. Match diagonal and enforce self-consistency. \(\mathcal{L}_{diag} = \int_0^1 \mathbb{E} \|\hat{v}_{s,s}(\bar{I}_s; t, x_t) - \bar{b}_s(\bar{I}_s; t, x_t)\|^2 ds\) \(\mathcal{L}_{cons} = \mathbb{E} \|\partial_s \bar{X}_{s,u} + \hat{v}_{s,s} \cdot \nabla \bar{X}_{s,u}\|^2\)</p> <h3 id="e-transition-matching-distillation-tmd">E. Transition Matching Distillation (TMD)</h3> <p><em>Motivation:</em> Video diffusion state spaces are too high-dimensional for direct trajectory distillation. TMD decouples the transformer backbone and flow head, chunking continuous trajectories into few-step discrete probability transitions.</p> <p><strong>Architecture:</strong> Outer transition: $x_{t_{i-1}} = x_{t_i} - (t_i - t_{i-1})y$. Inner flow parameterization: $y_{s_{j-1}} \approx f_\theta(y_{s_j}, s_j, s_{j-1}; m_\theta(x_{t_i}, t_i))$, where $m_\theta$ is the heavy semantic backbone and $f_\theta$ is a lightweight flow head. <strong>Objective:</strong> Stage 1 (Pretraining): Apply MeanFlow objective <em>strictly</em> to the isolated flow head $f_\theta$. \(\mathcal{L}_{TM} = \left\| u_\theta(y_s, s, r; m) - \text{sg}\left(v - (s-r)\frac{d}{ds}u_\theta\right) \right\|^2\) Stage 2 (Distribution Matching): Unroll inner transitions and optimize via variational score distillation (DMD2-v) against the full generative pipeline.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/" target="_blank" rel="external nofollow noopener">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2" target="_blank" rel="external nofollow noopener">Displaying External Posts on Your al-folio Blog</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Adam Abecid. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>